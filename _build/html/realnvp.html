<!DOCTYPE html>

<html lang="fr" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Module RealNVP &#8212; Documentation Implémentation des Normalizing Flows </title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=d1a510d7"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/translations.js?v=e6b791cb"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="next" title="Module Glow" href="glow.html" />
    <link rel="prev" title="Module NICE" href="nice.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-realnvp.real_nvp">
<span id="module-realnvp"></span><h1>Module RealNVP<a class="headerlink" href="#module-realnvp.real_nvp" title="Lien vers cette rubrique">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="realnvp.real_nvp.show_realnvp">
<span class="sig-prename descclassname"><span class="pre">realnvp.real_nvp.</span></span><span class="sig-name descname"><span class="pre">show_realnvp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#realnvp.real_nvp.show_realnvp" title="Lien vers cette définition">¶</a></dt>
<dd><p>Display the RealNVP model explanation page in the Streamlit application.</p>
<p>This function creates a comprehensive presentation of the RealNVP (Real-valued
Non-Volume Preserving) model, including its principles, architecture, innovations,
mathematical formulation, application to images, strengths, limitations, and impact.</p>
<p>The page includes visualizations of masking strategies and an interactive component
allowing users to experiment with the RealNVP model by adjusting hyperparameters and
visualizing results on different datasets.</p>
</dd></dl>

<dl class="py class" id="module-realnvp.train_realnvp">
<dt class="sig sig-object py" id="realnvp.train_realnvp.ImageDistribution">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">realnvp.train_realnvp.</span></span><span class="sig-name descname"><span class="pre">ImageDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blur_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#realnvp.train_realnvp.ImageDistribution" title="Lien vers cette définition">¶</a></dt>
<dd><p>Distribution based on an image for 2D density estimation.</p>
<p>This class converts a grayscale image into a probability distribution that can be
used as a target for training normalizing flows. The image intensity is treated as
a probability density, with appropriate normalization and smoothing.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>prob (numpy.ndarray): Normalized probability distribution derived from the image
resolution (int): Resolution of the discretized distribution
scale (float): Scale factor for the coordinate system
xx (numpy.ndarray): X-coordinates of the grid points
yy (numpy.ndarray): Y-coordinates of the grid points
prob_tensor (torch.Tensor): Tensor version of the probability distribution</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="realnvp.train_realnvp.ImageDistribution.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#realnvp.train_realnvp.ImageDistribution.log_prob" title="Lien vers cette définition">¶</a></dt>
<dd><p>Compute the log probability of samples under the image-based distribution.</p>
<p>This method evaluates the log probability of points in 2D space by mapping them
to pixels in the discretized image-based distribution.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>z (torch.Tensor): Input tensor of shape [batch_size, 2] representing points in 2D space</p>
</dd>
<dt>Returns:</dt><dd><p>torch.Tensor: Log probability for each input sample of shape [batch_size]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="realnvp.train_realnvp.ImageDistribution.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#realnvp.train_realnvp.ImageDistribution.sample" title="Lien vers cette définition">¶</a></dt>
<dd><p>Generate samples from the image-based distribution.</p>
<p>This method uses rejection sampling to generate points following the
probability distribution defined by the image.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>num_samples (int): Number of samples to generate</p>
</dd>
<dt>Returns:</dt><dd><p>torch.Tensor: Samples from the distribution of shape [num_samples, 2]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="realnvp.train_realnvp.execute_realnvp">
<span class="sig-prename descclassname"><span class="pre">realnvp.train_realnvp.</span></span><span class="sig-name descname"><span class="pre">execute_realnvp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_blocks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#realnvp.train_realnvp.execute_realnvp" title="Lien vers cette définition">¶</a></dt>
<dd><p>Executes the RealNVP model to learn a target distribution.</p>
<p>This function configures and trains a RealNVP model with a specified number of coupling blocks
and a maximum number of iterations. It displays intermediate results and the final loss curve.</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>n_blocks (int): The number of coupling blocks in the model. Each block typically consists</dt><dd><p>of two layers, so the total number of layers will be <cite>n_blocks * 2</cite>.</p>
</dd>
</dl>
<p>max_iter (int): The maximum number of iterations for training the model.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
<dt>Description:</dt><dd><ul class="simple">
<li><p>Configures the model parameters based on the specified number of blocks.</p></li>
<li><p>Initializes the RealNVP model with defined hyperparameters.</p></li>
<li><p>Trains the model over a specified number of iterations.</p></li>
<li><p>Displays thumbnails of the learned distribution at regular intervals.</p></li>
<li><p>Displays the loss curve at the end of training.</p></li>
</ul>
</dd>
<dt>Notes:</dt><dd><ul class="simple">
<li><p>Uses the Adam optimizer with a learning rate of 5e-4 and weight decay of 1e-5.</p></li>
<li><p>Displays thumbnails of the learned distribution every <cite>max_iter/10</cite> iterations.</p></li>
<li><p>Handles NaN or infinite values in the loss to prevent training interruptions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="realnvp.train_realnvp.plot_target_distribution">
<span class="sig-prename descclassname"><span class="pre">realnvp.train_realnvp.</span></span><span class="sig-name descname"><span class="pre">plot_target_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#realnvp.train_realnvp.plot_target_distribution" title="Lien vers cette définition">¶</a></dt>
<dd><p>Plot 2D target and learned distributions side by side.</p>
<p>This function creates a visualization comparing the target distribution
with the distribution learned by the model, displayed side by side.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (nf.NormalizingFlow): Trained RealNVP model
target: Target distribution object with log_prob method
xx (torch.Tensor): X-coordinates of the grid
yy (torch.Tensor): Y-coordinates of the grid
zz (torch.Tensor): Flattened grid points for evaluation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="realnvp.train_realnvp.setup_model">
<span class="sig-prename descclassname"><span class="pre">realnvp.train_realnvp.</span></span><span class="sig-name descname"><span class="pre">setup_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#realnvp.train_realnvp.setup_model" title="Lien vers cette définition">¶</a></dt>
<dd><p>Set up the RealNVP model and target distribution.</p>
<p>This function configures a RealNVP model with the specified number of coupling layers
and initializes an appropriate target distribution.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>image_path (str, optional): Path to image to use as distribution. Defaults to None.
num_layers (int, optional): Number of coupling layers. Defaults to 32.</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: A tuple containing:</dt><dd><ul class="simple">
<li><p>model (nf.NormalizingFlow): The configured RealNVP model</p></li>
<li><p>device (torch.device): Device for tensor operations (CPU/GPU)</p></li>
<li><p>target: Target distribution object (TwoMoons or ImageDistribution)</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="realnvp.train_realnvp.target_distribution">
<span class="sig-prename descclassname"><span class="pre">realnvp.train_realnvp.</span></span><span class="sig-name descname"><span class="pre">target_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#realnvp.train_realnvp.target_distribution" title="Lien vers cette définition">¶</a></dt>
<dd><p>Create a grid for visualizing the target distribution.</p>
<p>This function creates a 2D grid for visualizing a probability distribution,
returning tensors that can be used for creating contour plots or heatmaps.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>target: Target distribution object with a log_prob method
device (torch.device): Device for tensor operations (CPU/GPU)</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: A tuple containing:</dt><dd><ul class="simple">
<li><p>xx (torch.Tensor): X-coordinates of the grid</p></li>
<li><p>yy (torch.Tensor): Y-coordinates of the grid</p></li>
<li><p>zz (torch.Tensor): Flattened grid points for evaluation</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="realnvp.train_realnvp.train_model">
<span class="sig-prename descclassname"><span class="pre">realnvp.train_realnvp.</span></span><span class="sig-name descname"><span class="pre">train_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#realnvp.train_realnvp.train_model" title="Lien vers cette définition">¶</a></dt>
<dd><p>Train the RealNVP model on the target distribution.</p>
<p>This function trains a RealNVP model using stochastic gradient descent on samples
from the target distribution. It also visualizes the learning progress at regular intervals.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (nf.NormalizingFlow): RealNVP model to train
target: Target distribution object with sample method
xx (torch.Tensor): X-coordinates of the grid for visualization
yy (torch.Tensor): Y-coordinates of the grid for visualization
zz (torch.Tensor): Flattened grid points for evaluation
device (torch.device): Device for tensor operations (CPU/GPU)
max_iter (int, optional): Maximum number of training iterations. Defaults to 4000.
num_samples (int, optional): Number of samples per training batch. Defaults to 512 (2^9).
show_iter (int, optional): Interval for showing visualization updates. Defaults to 500.</p>
</dd>
<dt>Returns:</dt><dd><p>nf.NormalizingFlow: The trained RealNVP model</p>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Implémentation des Normalizing Flows</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="app.html">Application Streamlit</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation.html">Présentation du Sujet</a></li>
<li class="toctree-l1"><a class="reference internal" href="nice.html">Module NICE</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Module RealNVP</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#realnvp.real_nvp.show_realnvp"><code class="docutils literal notranslate"><span class="pre">show_realnvp()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#realnvp.train_realnvp.ImageDistribution"><code class="docutils literal notranslate"><span class="pre">ImageDistribution</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#realnvp.train_realnvp.execute_realnvp"><code class="docutils literal notranslate"><span class="pre">execute_realnvp()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#realnvp.train_realnvp.plot_target_distribution"><code class="docutils literal notranslate"><span class="pre">plot_target_distribution()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#realnvp.train_realnvp.setup_model"><code class="docutils literal notranslate"><span class="pre">setup_model()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#realnvp.train_realnvp.target_distribution"><code class="docutils literal notranslate"><span class="pre">target_distribution()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#realnvp.train_realnvp.train_model"><code class="docutils literal notranslate"><span class="pre">train_model()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glow.html">Module Glow</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="nice.html" title="Chapitre précédent">Module NICE</a></li>
      <li>Next: <a href="glow.html" title="Chapitre suivant">Module Glow</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Félix OLLIVIER & Mohammed LBAKALI.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/realnvp.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>